--- org.apache.commons.math.analysis.solvers.BrentSolver
+++ org.apache.commons.math.analysis.solvers.BrentSolver
@@ -174,7 +174,8 @@
                 setResult(max, 0);
                 ret = max;
             } else {
-                // neither value is close to zero and min and max do not bracket root.
+                setResult(yMin, 0);
+				// neither value is close to zero and min and max do not bracket root.
                 throw MathRuntimeException.createIllegalArgumentException(
                         "function values at endpoints do not have different signs.  " +
                         "Endpoints: [{0}, {1}], Values: [{2}, {3}]",
@@ -263,7 +264,27 @@
                     p = dx * r3;
                     p1 = 1.0 - r3;
                 } else {
-                    // Inverse quadratic interpolation.
+                    delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					delta = 0.5 * oldDelta;
+					// Inverse quadratic interpolation.
                     double r1 = y0 / y2;
                     double r2 = y1 / y2;
                     p = r3 * (dx * r1 * (r1 - r2) - (x1 - x0) * (r2 - 1.0));
